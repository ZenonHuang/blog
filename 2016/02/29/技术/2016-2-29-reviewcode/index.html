
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>reviewcode.cn平台部分案例整理 | blog of zzgo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="zzgo">
    
    <meta name="description" itemprop="description" content="iOS资料整理">
    
    <meta name="keywords" content="iOS">
    
    
    <link rel="alternate" href="/atom.xml" title="blog of zzgo" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="blog of zzgo" title="blog of zzgo"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="blog of zzgo">blog of zzgo</a></h1>
				<h2 class="blog-motto">代码小工的作坊</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/resource">资源</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:zzgoblog.cc">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/02/29/技术/2016-2-29-reviewcode/" title="reviewcode.cn平台部分案例整理" itemprop="url">reviewcode.cn平台部分案例整理</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://zzgoblog.cc" title="zzgo">zzgo</a>
    </p>
  <p class="article-time">
    <time datetime="2016-02-28T16:00:00.000Z" itemprop="datePublished">2016-02-29</time>
    更新日期:<time datetime="2016-04-09T13:57:16.000Z" itemprop="dateModified">2016-04-09</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#彦祖大神的codeReview平台"><span class="toc-number">1.</span> <span class="toc-text">彦祖大神的codeReview平台</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#平台案例整理"><span class="toc-number">2.</span> <span class="toc-text">平台案例整理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么要做CodeReview？"><span class="toc-number">2.1.</span> <span class="toc-text">为什么要做CodeReview？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#一-命名规范"><span class="toc-number">2.2.</span> <span class="toc-text">一. 命名规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二-编码细节"><span class="toc-number">2.3.</span> <span class="toc-text">二.编码细节</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）数字与常量"><span class="toc-number">2.3.1.</span> <span class="toc-text">1）数字与常量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）监听通知的位置"><span class="toc-number">2.3.2.</span> <span class="toc-text">2）监听通知的位置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）-私有成员-or-Property"><span class="toc-number">2.3.3.</span> <span class="toc-text">3） 私有成员 or Property</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4）-typedef-block"><span class="toc-number">2.3.4.</span> <span class="toc-text">4） typedef block</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5）-数字类型"><span class="toc-number">2.3.5.</span> <span class="toc-text">5） 数字类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6）属性修饰符建议"><span class="toc-number">2.3.6.</span> <span class="toc-text">6）属性修饰符建议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7）-字面量语法"><span class="toc-number">2.3.7.</span> <span class="toc-text">7） 字面量语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三-设计思路"><span class="toc-number">2.4.</span> <span class="toc-text">三.设计思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）公有私有混乱"><span class="toc-number">2.4.1.</span> <span class="toc-text">1）公有私有混乱</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）消息通知满天飞"><span class="toc-number">2.4.2.</span> <span class="toc-text">2）消息通知满天飞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）单个对象多职责"><span class="toc-number">2.4.3.</span> <span class="toc-text">3）单个对象多职责</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4）盲目新增功能"><span class="toc-number">2.4.4.</span> <span class="toc-text">4）盲目新增功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5）滥用委托"><span class="toc-number">2.4.5.</span> <span class="toc-text">5）滥用委托</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6）静态DataSource"><span class="toc-number">2.4.6.</span> <span class="toc-text">6）静态DataSource</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7）使用orm"><span class="toc-number">2.4.7.</span> <span class="toc-text">7）使用orm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8）构建易于测试的模块"><span class="toc-number">2.4.8.</span> <span class="toc-text">8）构建易于测试的模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9）不要想当然的使用tableView"><span class="toc-number">2.4.9.</span> <span class="toc-text">9）不要想当然的使用tableView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10）圆角"><span class="toc-number">2.4.10.</span> <span class="toc-text">10）圆角</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-App沙盒数据存储目录"><span class="toc-number">2.4.11.</span> <span class="toc-text">11) App沙盒数据存储目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12）-即时抽取函数"><span class="toc-number">2.4.12.</span> <span class="toc-text">12） 即时抽取函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13）-使用懒加载"><span class="toc-number">2.4.13.</span> <span class="toc-text">13） 使用懒加载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13）delegate校验参数"><span class="toc-number">2.4.14.</span> <span class="toc-text">13）delegate校验参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四-项目配置"><span class="toc-number">2.5.</span> <span class="toc-text">四. 项目配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）目录结构"><span class="toc-number">2.5.1.</span> <span class="toc-text">1）目录结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）合理高效的开发环境"><span class="toc-number">2.5.2.</span> <span class="toc-text">2）合理高效的开发环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）第三方库管理"><span class="toc-number">2.5.3.</span> <span class="toc-text">3）第三方库管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-自动打包配置"><span class="toc-number">2.5.4.</span> <span class="toc-text">4) 自动打包配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#持续更新"><span class="toc-number">2.6.</span> <span class="toc-text">持续更新</span></a></li></ol></li></ol>
		</div>
		
		<blockquote>
<p>原文来自简书：<a href="http://www.jianshu.com/p/ae1090183fa8?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=writer_share&amp;utm_source=weibo" target="_blank" rel="external">reviewcode.cn 平台部分案例整理</a></p>
</blockquote>
<p>我是大神们的搬运工</p>
<h2 id="彦祖大神的codeReview平台"><a href="#彦祖大神的codeReview平台" class="headerlink" title="彦祖大神的codeReview平台"></a>彦祖大神的codeReview平台</h2><p>@叶孤城___ 大神搞了一个提供邀请业内大神付费为你的项目进行CodeReview的平台，产出一份高质量的review报告。<a href="www.reviewcode.cn">www.reviewcode.cn</a></p>
<h2 id="平台案例整理"><a href="#平台案例整理" class="headerlink" title="平台案例整理"></a>平台案例整理</h2><p>可能不见得每个人都要把自己所有的项目，扔到平台上让大神们review，但是我们可以进行归纳总结，在那些大神们的<code>高质量review报告</code>中，归纳和总结我们自己需要的，汲取养分。</p>
<p>更何况这些总结，每一个都包含着真实的代码案例，优化方案，以及原因详解，比我们每天看设计模式那些抽象的理念，名词，要接地气的多</p>
<p>我不是大神，我只是大神的搬运工</p>
<p>(农夫山泉的广告词…咳…装X了…跑题了…)</p>
<p>目前CodeReview平台上已经有了超级详尽的10篇review报告，每一个都是实打实的干活，所以我就搬运一下，把他们case by case 的review报告，梳理归类一下，换个形式进行总结和学习</p>
<h3 id="为什么要做CodeReview？"><a href="#为什么要做CodeReview？" class="headerlink" title="为什么要做CodeReview？"></a>为什么要做CodeReview？</h3><p>引用大神在网站中的一句话</p>
<blockquote>
<p>因为 Code Review 是一种最快捷有效的方式让你清楚地知道“好的代码是怎样写出的”。不知道你们有没有这样的经历。</p>
<p>知道如何完成一个功能，或者完成一个组件。但是碰到稍微复杂的逻辑和业务，就会很容易的让代码变得一团糟。书中常常提及的解耦、分拆复杂逻辑都似乎变成了纸上谈兵，无从下手。又或者，总觉得自己的代码哪里不对劲，和高手们写的简洁、易懂、风格优雅的代码总是有似乎逾越不了的鸿沟。</p>
</blockquote>
<p>我个人是觉得，代码能力的培养，代码质量的提升，不仅仅是我又学到了什么新技术，掌握了什么nb的黑科技。</p>
<p>更离不开对自己写出的每一句代码的反复challenge，小到命名规范，数字常量，大到模块设计，项目结构，无处不存在着可以不断优化和提升的细节。</p>
<p>看看行业的高手大神们是怎么思考和写码的，看看他们在跟你思考一模一样的问题的时候，他们视野他们的角度，学习，汲取，不断地提升自己</p>
<blockquote>
<p>观一叶而知秋，道不远人即为此</p>
</blockquote>
<p>代码的<code>道</code>，其实就在这些点点滴滴的细节所汇聚而成的<code>艺术品</code>里（咳…装X了…跑题了…）</p>
<h3 id="一-命名规范"><a href="#一-命名规范" class="headerlink" title="一. 命名规范"></a>一. 命名规范</h3><p>在10篇review报告中有3篇提到了命名规范这个事情</p>
<ul>
<li><a href="http://www.reviewcode.cn/article.html?reviewId=8" target="_blank" rel="external">一些代码建议</a></li>
<li><a href="http://www.reviewcode.cn/article.html?reviewId=3" target="_blank" rel="external">要你命三千：老代码中的那些坑</a></li>
<li><a href="http://www.reviewcode.cn/article.html?reviewId=2" target="_blank" rel="external">命名的艺术</a></li>
</ul>
<p>其实关于命名规范，有很多现成的方法论和规范了，各种语言，对于类，函数，变量，等等，一查都能查到很多。我觉得这里面最重要的意义是让你写出的东西别人好读，好认，不要靠猜。</p>
<p>大神们给出了很多建议</p>
<ul>
<li>前缀：建议所有类名、enum 定义、typedef 类型定义，都加上前缀（prefix）</li>
<li>拼写错误：不用多说了</li>
<li>命名规范：建议尽可能统一，就算多人团队合作，在开发中统一一下习惯总是好的。<ul>
<li>比如到底是_分割还是驼峰大小写分割单词？（建议驼峰）</li>
<li>是否对返回值的类型描述写入函数名，方法名里面？（建议写像苹果系统Api）</li>
</ul>
</li>
</ul>
<p><a href="http://www.reviewcode.cn/article.html?reviewId=2" target="_blank" rel="external">命名的艺术</a>这篇报告更是着重的对命名规范从四个方向进行了很深入的剖析</p>
<ul>
<li>变量的命名</li>
<li>代理的命名</li>
<li>图片资源的命名</li>
<li>方法的命名</li>
</ul>
<h3 id="二-编码细节"><a href="#二-编码细节" class="headerlink" title="二.编码细节"></a>二.编码细节</h3><p>写代码的时候，有时候很细微的一行代码，稍加变化，稍加处理，可能就会有很多性能，可读性，扩展性等得提升，在10篇review报告中，有太多这样高质量的编码细节干活。</p>
<h4 id="1）数字与常量"><a href="#1）数字与常量" class="headerlink" title="1）数字与常量"></a>1）数字与常量</h4><ul>
<li><a href="http://www.reviewcode.cn/article.html?reviewId=3" target="_blank" rel="external">要你命三千：老代码中的那些坑</a></li>
<li><a href="http://www.reviewcode.cn/article.html?reviewId=7" target="_blank" rel="external">关于性能的一些问题</a></li>
<li><a href="http://www.reviewcode.cn/article.html?reviewId=10" target="_blank" rel="external">好的代码习惯</a></li>
<li><a href="http://www.reviewcode.cn/article.html?reviewId=4" target="_blank" rel="external">一些优化代码结构的方法</a></li>
</ul>
<p>都提到了<code>数字</code>，比如</p>
<p># </p>
<pre><code>UILabel *infoLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 241, 320, 28)];
</code></pre><p>这个还算好的，再看看这个</p>
<pre><code>CGRect rect = CGRectMake(12.2+(page-1)*320+42.5*(i%7),((totalRows-1)%3)*55+2,42.5,42.5);
</code></pre><p>大神们建议这么使用</p>
<pre><code>static const CGFloat kTagHeight = 30.0f;
static const CGFloat kTagLabelWidthInset = 16.0f;
</code></pre><p>另外，不建议用宏，具体有兴趣大家可以看简书的这个帖子 ，<a href="http://www.jianshu.com/p/c941e37a8a1d" target="_blank" rel="external">iOS中关于宏定义与常量的使用</a>，简单的说就是宏会增加编译速度</p>
<p>同理一些字符串<code>常量</code>等，都建议使用 这样的定义</p>
<pre><code>static NSString *const kcircleModelDataCategoryName = @&quot;categoryName&quot;;
</code></pre><h4 id="2）监听通知的位置"><a href="#2）监听通知的位置" class="headerlink" title="2）监听通知的位置"></a>2）监听通知的位置</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=4" target="_blank" rel="external">一些优化代码结构的方法</a></p>
<blockquote>
<p>有人在willAppear和Disappear中添加通知，这样极容易出现问题。因为willAppear和Disappear出现的顺序并不一定是一对一的。所以有可能造成多次添加，多次移除通知。</p>
</blockquote>
<p>大神们建议这么使用</p>
<blockquote>
<p>建议在viewDidLoad里添加通知。在dealloc里移除通知。</p>
</blockquote>
<h4 id="3）-私有成员-or-Property"><a href="#3）-私有成员-or-Property" class="headerlink" title="3） 私有成员 or Property"></a>3） 私有成员 or Property</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=9" target="_blank" rel="external">话谈 iOS 目录结构的划分</a>中提到的一个问题</p>
<pre><code>@interface PartyViewController ()

@property (weak, nonatomic) IBOutlet UITableView *partyTableView;
@property (strong,nonatomic) NSMutableArray *partys;
@end

@implementation PartyViewController{

    NSMutableArray *lodedIndex;
}
</code></pre><p>到底该用哪一个？</p>
<p>大婶们的建议是</p>
<blockquote>
<p>无论如何，应该一致，应该统一风格。建议这里用 property 。因为 @IBOutlet ，从 IB 拖出来的属性用的就是 property ，所以统一用 property 较好。</p>
</blockquote>
<p>关于这个，其实在开发中有一定的争议的，有兴趣的可以看一下唐巧老师的这篇文章，<a href="http://blog.devtang.com/2015/03/15/ios-dev-controversy-1/" target="_blank" rel="external">开发中得争议</a></p>
<h4 id="4）-typedef-block"><a href="#4）-typedef-block" class="headerlink" title="4） typedef block"></a>4） typedef block</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=9" target="_blank" rel="external">话谈 iOS 目录结构的划分</a> 提到代码中多次使用的block，诸如<code>(void (^)(NSError *error))</code>等，可以统一进行声明，不要每次都手打完整block定义</p>
<p>好处是</p>
<blockquote>
<p>还可以用上 Xcode 的自动补全功能，当你输入 Fa 的时候， FailureBlock 的提示就出来了。用 (void (^)(NSError *error)) 就没有自动补全了，每次都要手工输入一遍，很麻烦</p>
</blockquote>
<h4 id="5）-数字类型"><a href="#5）-数字类型" class="headerlink" title="5） 数字类型"></a>5） 数字类型</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=9" target="_blank" rel="external">话谈 iOS 目录结构的划分</a>中提到了3个问题</p>
<ul>
<li>用 int 还是 NSInteger</li>
<li>尺寸变量统一用 CGFloat</li>
<li>选用正确的类型，让编译器能静态检查</li>
</ul>
<p>第一个问题</p>
<blockquote>
<p>可以注意到 apple 的 UIKit 等代码一般都是用的 NSInteger。NSInteger 在 32位系统是 int ，64位系统是 long 。Apple 把它用在函数的参数处，和返回的地方。为什么？因为函数是需要跟其它代码或其它平台的代码交流互动的，所以是 int 还是 long 很重要。系统的代码用的是 NSInteger 的话，你的用了 int 的话，可能不够大而造成崩溃。</p>
</blockquote>
<p>还是建议NSInteger</p>
<p>第二个问题 </p>
<blockquote>
<p>一开始看到 <code>int padding = 1</code> 后，不知道它是干嘛的。因为附近没有它的代码，看到后面才知道的。所以声明类型为 CGFloat ，更容易知道它是来定义尺寸距离的。</p>
</blockquote>
<p>为什么建议这样，CG开头是CoreGraphic的简写，我们开发也会发现CGFloat 是需要 import <code>UIKit</code>的，从名字定义上，他是与现实UI有关的</p>
<p>第三个问题</p>
<p>具体可以看链接里的案例</p>
<p>简单的说就是，很多NSInterger等数值属性，不要把他定义成NSNumber，因为编译器在发现你对integer变量赋值float变量的时候会自动报错，是一个自动纠错的功能，如果定义成了NSNumber，用语法糖@（float）去转换，就不能自动纠错了</p>
<h4 id="6）属性修饰符建议"><a href="#6）属性修饰符建议" class="headerlink" title="6）属性修饰符建议"></a>6）属性修饰符建议</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=10" target="_blank" rel="external">好的代码习惯</a></p>
<blockquote>
<p>在arc中，弱引用最好使用weak，来避免野指针的出现，weak可以在指向的对象dealloc的时候自动置为nil。</p>
<p>在arc中强引用尽量使用strong，当然这里strong和retain的作用是一样的，但是为了保持代码的一致性，这里推荐使用strong。</p>
</blockquote>
<p>具体可以看链接中得案例</p>
<h4 id="7）-字面量语法"><a href="#7）-字面量语法" class="headerlink" title="7） 字面量语法"></a>7） 字面量语法</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=10" target="_blank" rel="external">好的代码习惯</a></p>
<pre><code>_comps.items = [NSArray arrayWithObjects:_photoBarButton, _mediaBarButton, _alarmBarButton, _brushBarButton, _voiceBarButton, _doneBarButton, nil];
</code></pre><p>字面量语法</p>
<pre><code>_comps.items = @[_photoBarButton, _mediaBarButton, _alarmBarButton, _brushBarButton, _voiceBarButton, _doneBarButton];
</code></pre><blockquote>
<p>这种做法不仅简单，还更加安全。假如当中的_alarmBarButton为nil，那么通过第一种写法，数组还是会创建出来，只不过数组内只有2个对象，原因在于，“arrayWithObjects:”方法会依次处理各个参数，直到发现nil为止，而第二种写法会在插入nil指针的时候抛出异常，令程序终止运行，这比创建好数组后才发现数组内的元素个数少了要好很多。异常往往能更快地发现错误。</p>
</blockquote>
<h3 id="三-设计思路"><a href="#三-设计思路" class="headerlink" title="三.设计思路"></a>三.设计思路</h3><h4 id="1）公有私有混乱"><a href="#1）公有私有混乱" class="headerlink" title="1）公有私有混乱"></a>1）公有私有混乱</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=3" target="_blank" rel="external">要你命三千：老代码中的那些坑</a></p>
<p>具体案例可以看Link中得细节，大致思路是尽可能的减少接口在头文件中所暴露出来的属性和方法，头文件要尽可能的简洁</p>
<p>如果有可能也尽量避免，一个头文件中出现多个类声明</p>
<blockquote>
<p>头文件里地方小，塞到一处并不好。 外部对象都知道，安全问题可不小</p>
</blockquote>
<h4 id="2）消息通知满天飞"><a href="#2）消息通知满天飞" class="headerlink" title="2）消息通知满天飞"></a>2）消息通知满天飞</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=3" target="_blank" rel="external">要你命三千：老代码中的那些坑</a></p>
<p>通知虽好，但也不要贪杯啊。</p>
<blockquote>
<p>看起来轻松，只是 post 了一下就搞定了，但是在 Debug 的时候有点麻烦。尤其是如果有多个 Observer ，改动的时候牵一发而动全身。如果真的是有这样使用的必要倒也罢了，但是本来一个 block 或者 delegate 就能简单清晰的解决，现在却被搞得这么繁重，实在是没有必要。</p>
</blockquote>
<p>我觉得明确使用通知的场景，在不需要一对多的情况下，路径不算远的2个模块，完全可以通过delegate，或者block解决</p>
<h4 id="3）单个对象多职责"><a href="#3）单个对象多职责" class="headerlink" title="3）单个对象多职责"></a>3）单个对象多职责</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=3" target="_blank" rel="external">要你命三千：老代码中的那些坑</a></p>
<p>同一个一个模块</p>
<ul>
<li>上能和服务器聊天，上传聊天消息同步聊天记录</li>
<li>下能做本地缓存管理，增删改查样样精通</li>
<li>弹窗提醒，上传进度，完成提示，亦是轻松拿下。</li>
<li>以至于你改着改着不知不觉都会走到这里，因为它处理了太多太多的业务逻辑，每次 DEBUG 追杀断点回到这里，都像是一场久别重逢时的相遇，似曾相识</li>
</ul>
<blockquote>
<p>一人做事一人当，切忌都往类里装。 开发人员干的爽，维护人员很受伤。</p>
</blockquote>
<h4 id="4）盲目新增功能"><a href="#4）盲目新增功能" class="headerlink" title="4）盲目新增功能"></a>4）盲目新增功能</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=3" target="_blank" rel="external">要你命三千：老代码中的那些坑</a></p>
<p>具体案例可以看Link中的细节，简单描述下就是，随着项目的迭代，一个小功能点，多一个标记位，再来一个小功能点，又多一个标记位，随着业务迭代下去，标记位越来越多，如果这里面涉及到逻辑上的关联，一单有个标记位得特殊处理一下，那N个<code>if</code>嵌套的场景，简直是<code>画美不看</code></p>
<p>新增的业务需求，还是要经常和老功能进行梳理和总结，该合并该梳理的都要重新和老代码里一起整合，切记直接拍脑袋上手直接添加功能</p>
<h4 id="5）滥用委托"><a href="#5）滥用委托" class="headerlink" title="5）滥用委托"></a>5）滥用委托</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=3" target="_blank" rel="external">要你命三千：老代码中的那些坑</a></p>
<p><a href="http://www.reviewcode.cn/article.html?reviewId=5" target="_blank" rel="external">封装一个UI控件的范例</a></p>
<p>都提到了在处理回调的时候，委托或者block的2个方式的对比</p>
<blockquote>
<p>所谓悲哀就是，当程序员发现一个 delegate 就能访问上级的对象，于是便把各种需要通知上级的事情都放在了委托方法里，尽管这些事情与委托本身无关，但是为了实现功能已经不在意这些所谓的设计与美观</p>
<p>可以考虑用block来传递数据源和响应事件，这样封装的view在代码的连贯性上更好一些</p>
</blockquote>
<p>简单的说结合具体案例，恰当的采用委托或者block来实现</p>
<h4 id="6）静态DataSource"><a href="#6）静态DataSource" class="headerlink" title="6）静态DataSource"></a>6）静态DataSource</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=4" target="_blank" rel="external">一些优化代码结构的方法</a></p>
<p>开发中难免会遇到很多静态的几乎很少变化的tableView界面</p>
<p>图省事的人直接在代码里 switchCase  一行行的硬编码，写死了整个tableview的界面</p>
<p>还是推荐使用plist，用代码从数据源中读取数据，从而进行展示</p>
<blockquote>
<p>这样，后续迭代版本的内容只需要修改plist文件的内容就可以了。而不需要在代码中修改逻辑。</p>
</blockquote>
<h4 id="7）使用orm"><a href="#7）使用orm" class="headerlink" title="7）使用orm"></a>7）使用orm</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=4" target="_blank" rel="external">一些优化代码结构的方法</a></p>
<p>很多人都是这么做的</p>
<p>不要在解析网络等数据的时候，手写解析过程，采用<code>mantle</code>or<code>JsonModel</code>等框架来做这些事情</p>
<h4 id="8）构建易于测试的模块"><a href="#8）构建易于测试的模块" class="headerlink" title="8）构建易于测试的模块"></a>8）构建易于测试的模块</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=4" target="_blank" rel="external">一些优化代码结构的方法</a><br><a href="http://www.reviewcode.cn/article.html?reviewId=1" target="_blank" rel="external">如何打造令人愉悦的开发环境</a></p>
<p>都提到了，尽量在开发中设计易于测试的模块。<br>众多功能杂糅在一个类里面是不利于测试的，写一个超大函数，干了很多功能也是不利于编写自动化测试的<br>后面还会提到，随着项目的逐渐扩大，保持至健壮的自动化测试+持续集成，才是一个健康的项目结构</p>
<h4 id="9）不要想当然的使用tableView"><a href="#9）不要想当然的使用tableView" class="headerlink" title="9）不要想当然的使用tableView"></a>9）不要想当然的使用tableView</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=6" target="_blank" rel="external">不要想当然的使用tableView</a></p>
<ul>
<li>不要试图过分的复用一个TableViewController</li>
<li>一定要复用的场景<ul>
<li>用switch来区分场景，用不同的tableview进行处理</li>
<li>将数据源的判断逻辑，不同的tableview类给自己处理自己的<code>delegate</code> or <code>datasource</code></li>
<li>这样多路复用的选择其实就发生在了返回tableView的操作里，可以避免在控制器中出现臃肿的代码</li>
</ul>
</li>
<li>不要试图滥用Cell的重用机制</li>
</ul>
<h4 id="10）圆角"><a href="#10）圆角" class="headerlink" title="10）圆角"></a>10）圆角</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=7" target="_blank" rel="external">关于性能的一些问题</a></p>
<p>详细可以看关于离屏渲染的Link中的介绍，<br>也可以看另一位大神ibireme对渲染流畅的文章，<a href="http://blog.ibireme.com/2015/11/12/smooth_user_interfaces_for_ios/" target="_blank" rel="external">iOS 保持界面流畅的技巧</a></p>
<p>简单的说就是<code>CALayer</code>的<code>圆角</code>和<code>阴影</code>，当出现在大量的cell之中，会进项很多的离屏渲染，这样就会大幅度拖慢FPS</p>
<p>如何解决？</p>
<blockquote>
<p>圆角使用UIImageView来处理。<br>简单来说，底层铺一个UIImageView,然后用GraphicsContext生成一张带圆角的图。</p>
</blockquote>
<h4 id="11-App沙盒数据存储目录"><a href="#11-App沙盒数据存储目录" class="headerlink" title="11) App沙盒数据存储目录"></a>11) App沙盒数据存储目录</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=8" target="_blank" rel="external">一些代码建议</a></p>
<blockquote>
<p>数据存储应该再谨慎一些，至少用户数据可以放在 Documents 文件夹下某个子目录里，而不应该直接丢到 Documents 文件夹下，清空时也不应该清空整个 Documents 文件夹。</p>
</blockquote>
<p>PS:顺带我想说，如果app配置了itunes查看Documents的功能，apple审核的时候会查看documents目录，一些非用户可感知的数据，程序生成的数据，存放在Doc目录下，可能会被苹果拒审</p>
<h4 id="12）-即时抽取函数"><a href="#12）-即时抽取函数" class="headerlink" title="12） 即时抽取函数"></a>12） 即时抽取函数</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=9" target="_blank" rel="external">话谈 iOS 目录结构的划分</a></p>
<p>可以细看Link中的案例</p>
<p>简单描述就是，随着业务的不断增长，有时候会出现超长的函数，有时候会有相似代码，被写出来，适当的即时抽取函数，减少超长代码，减少近似冗余代码</p>
<h4 id="13）-使用懒加载"><a href="#13）-使用懒加载" class="headerlink" title="13） 使用懒加载"></a>13） 使用懒加载</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=10" target="_blank" rel="external">好的代码习惯</a></p>
<pre><code> [self initComps];
[self initToolbar];
[self initVertical];
[self initImageView];
[self initMediaPick];
[self setupSpeechRecognizer];
[self initAttributedString];
[self initTextView];
</code></pre><p>这样的代码，推荐使用懒加载</p>
<blockquote>
<p>懒加载带来的收益：我们不再需要显式的生成和调用initAttributedString方法，只需要在使用的时候调用属性self.attrString，对象的实例化全部放在getter中，可以有效降低代码的耦合度;在使用属性之前，属性并不会提前生成，减少内存占用。</p>
</blockquote>
<h4 id="13）delegate校验参数"><a href="#13）delegate校验参数" class="headerlink" title="13）delegate校验参数"></a>13）delegate校验参数</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=10" target="_blank" rel="external">好的代码习惯</a></p>
<pre><code>- (void)textViewDidEndEditing:(YYTextView *)textView {
    if (textView == self.textView) {
        self.navigationItem.rightBarButtonItem = nil;
    }
}
</code></pre><blockquote>
<p>如果你的delegate方法，只作为一个textView的委托回调，这种写法没有任何。但是如果你想扩展你的界面，在将来的界面中很可能出现另一个textView，这时你就必须区分这两个textView是谁回调了这个代理方法</p>
</blockquote>
<h3 id="四-项目配置"><a href="#四-项目配置" class="headerlink" title="四. 项目配置"></a>四. 项目配置</h3><h4 id="1）目录结构"><a href="#1）目录结构" class="headerlink" title="1）目录结构"></a>1）目录结构</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=9" target="_blank" rel="external">话谈iOS目录结构的划分</a></p>
<p>提到了MVC结构，以及MVC结构下如何划分目录结构</p>
<blockquote>
<p>往往业界有两种做法：</p>
<p>先按业务划分，再按照 MVC 来划分</p>
<p>先按 MVC 划分，再按照业务划分</p>
<p>第一种的好处是把相应业务的代码放在一起，找特别好找，相应的 xib、model 和 ViewController 全在一个地方。在这些代码之间跳转特别方便。Telegram 非常大的代码量，也是这么组织的。个人觉得如果代码量特别大，这种划分方式其实更好，先按照业务划分了，更容易分工合作。</p>
<p>第二种似乎更多人用。Yep 也是按照这样的方式组织。</p>
<p>其实我觉得都可以，看个人习惯。</p>
</blockquote>
<p>PS:我表示，我可能更习惯<code>先按业务模块划分，再MVC</code></p>
<h4 id="2）合理高效的开发环境"><a href="#2）合理高效的开发环境" class="headerlink" title="2）合理高效的开发环境"></a>2）合理高效的开发环境</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=1" target="_blank" rel="external">如何打造令人愉悦的开发环境</a></p>
<p>这个案例里面详尽探讨了一个观点 <code>一个合理高效的开发环境应该是依托于自动化之上的.</code></p>
<p>自动化应当包含以下几个方面:</p>
<ul>
<li>代码风格检查</li>
<li>自动化测试</li>
<li>持续集成</li>
<li>常用库的封装和打包</li>
</ul>
<h4 id="3）第三方库管理"><a href="#3）第三方库管理" class="headerlink" title="3）第三方库管理"></a>3）第三方库管理</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=1" target="_blank" rel="external">如何打造令人愉悦的开发环境</a><br><a href="http://www.reviewcode.cn/article.html?reviewId=3" target="_blank" rel="external">要你命三千：老代码中的那些坑</a></p>
<ul>
<li>各种第三方库推荐使用cocoapods管理，提高效率</li>
<li>项目勤用三方库，随意穿插改无数。 即使类库有更新，试问代码谁维护</li>
</ul>
<h4 id="4-自动打包配置"><a href="#4-自动打包配置" class="headerlink" title="4) 自动打包配置"></a>4) 自动打包配置</h4><p><a href="http://www.reviewcode.cn/article.html?reviewId=11" target="_blank" rel="external">iOS下如何自动化打包App</a></p>
<ul>
<li>自动化的全面配置打包平台的一个方案</li>
</ul>
<h3 id="持续更新"><a href="#持续更新" class="headerlink" title="持续更新"></a>持续更新</h3><p>codeReview应该持续进行下去，这个总结也应该持续进行。</p>
<p>扔到Git上吧，<a href="https://github.com/Awhisper/iOSCodeReviewTipsCollection" target="_blank" rel="external">iOSCodeReviewTipsCollection</a>，（╮(╯_╰)╭ 又TM是广告)</p>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/资料/">资料</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/技术/">技术</a>
</div>



<div class="article-share" id="share">

  
<div class="jiathis_style">
    <span class="jiathis_txt">分享到：</span>
    <a class="jiathis_button_tsina">新浪微博</a>
    <a class="jiathis_button_weixin">微信</a>
    <a class="jiathis_button_twitter">Twitter</a>
    <a class="jiathis_button_evernote">EverNote</a>
    <a href="http://www.jiathis.com/share?uid=1501277" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
</div>
<script type="text/javascript" >
    var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",
     ralateuid:{"tsina":"1642909335## e.g. 1664838973 Your weibo id,It will be used in share button."},hideMore:false}
    
  </script> 
<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=
2112728" charset="utf-8"></script>      


</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2016/03/23/技术/2016-3-23-ALAsset/" title="照片框架ALAssetsLibrary">
  <strong>PREVIOUS:</strong><br/>
  <span>
  照片框架ALAssetsLibrary</span>
</a>
</div>


<div class="next">
<a href="/2016/02/01/生活/2016-2-1-PlanOfiOS/"  title="iOS技能图谱">
 <strong>NEXT:</strong><br/> 
 <span>iOS技能图谱
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#彦祖大神的codeReview平台"><span class="toc-number">1.</span> <span class="toc-text">彦祖大神的codeReview平台</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#平台案例整理"><span class="toc-number">2.</span> <span class="toc-text">平台案例整理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么要做CodeReview？"><span class="toc-number">2.1.</span> <span class="toc-text">为什么要做CodeReview？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#一-命名规范"><span class="toc-number">2.2.</span> <span class="toc-text">一. 命名规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二-编码细节"><span class="toc-number">2.3.</span> <span class="toc-text">二.编码细节</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）数字与常量"><span class="toc-number">2.3.1.</span> <span class="toc-text">1）数字与常量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）监听通知的位置"><span class="toc-number">2.3.2.</span> <span class="toc-text">2）监听通知的位置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）-私有成员-or-Property"><span class="toc-number">2.3.3.</span> <span class="toc-text">3） 私有成员 or Property</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4）-typedef-block"><span class="toc-number">2.3.4.</span> <span class="toc-text">4） typedef block</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5）-数字类型"><span class="toc-number">2.3.5.</span> <span class="toc-text">5） 数字类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6）属性修饰符建议"><span class="toc-number">2.3.6.</span> <span class="toc-text">6）属性修饰符建议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7）-字面量语法"><span class="toc-number">2.3.7.</span> <span class="toc-text">7） 字面量语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三-设计思路"><span class="toc-number">2.4.</span> <span class="toc-text">三.设计思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）公有私有混乱"><span class="toc-number">2.4.1.</span> <span class="toc-text">1）公有私有混乱</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）消息通知满天飞"><span class="toc-number">2.4.2.</span> <span class="toc-text">2）消息通知满天飞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）单个对象多职责"><span class="toc-number">2.4.3.</span> <span class="toc-text">3）单个对象多职责</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4）盲目新增功能"><span class="toc-number">2.4.4.</span> <span class="toc-text">4）盲目新增功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5）滥用委托"><span class="toc-number">2.4.5.</span> <span class="toc-text">5）滥用委托</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6）静态DataSource"><span class="toc-number">2.4.6.</span> <span class="toc-text">6）静态DataSource</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7）使用orm"><span class="toc-number">2.4.7.</span> <span class="toc-text">7）使用orm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8）构建易于测试的模块"><span class="toc-number">2.4.8.</span> <span class="toc-text">8）构建易于测试的模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9）不要想当然的使用tableView"><span class="toc-number">2.4.9.</span> <span class="toc-text">9）不要想当然的使用tableView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10）圆角"><span class="toc-number">2.4.10.</span> <span class="toc-text">10）圆角</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-App沙盒数据存储目录"><span class="toc-number">2.4.11.</span> <span class="toc-text">11) App沙盒数据存储目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12）-即时抽取函数"><span class="toc-number">2.4.12.</span> <span class="toc-text">12） 即时抽取函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13）-使用懒加载"><span class="toc-number">2.4.13.</span> <span class="toc-text">13） 使用懒加载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13）delegate校验参数"><span class="toc-number">2.4.14.</span> <span class="toc-text">13）delegate校验参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四-项目配置"><span class="toc-number">2.5.</span> <span class="toc-text">四. 项目配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）目录结构"><span class="toc-number">2.5.1.</span> <span class="toc-text">1）目录结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）合理高效的开发环境"><span class="toc-number">2.5.2.</span> <span class="toc-text">2）合理高效的开发环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）第三方库管理"><span class="toc-number">2.5.3.</span> <span class="toc-text">3）第三方库管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-自动打包配置"><span class="toc-number">2.5.4.</span> <span class="toc-text">4) 自动打包配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#持续更新"><span class="toc-number">2.6.</span> <span class="toc-text">持续更新</span></a></li></ol></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/技术/" title="技术">技术<sup>14</sup></a></li>
		
			<li><a href="/categories/生活/" title="生活">生活<sup>5</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/实习工作/" title="实习工作">实习工作<sup>7</sup></a></li>
		
			<li><a href="/tags/资料/" title="资料">资料<sup>6</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello <br/>
			This is my blog</p>
	</section>
	 
	<div class="social-font clearfix">
		
		<a href="http://weibo.com/zzgoCC" target="_blank" title="weibo"></a>
		
		
		
		<a href="https://github.com/zzgo" target="_blank" title="github"></a>
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2016 
		
		<a href="http://zzgoblog.cc" target="_blank" title="zzgo">zzgo</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"6246326451579127000"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



  </body>
</html>
